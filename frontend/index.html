<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue & Flask Todo App</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Vue.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/vue@3"></script>
</head>
<body class="bg-gray-100 p-8 flex justify-center items-center h-screen">
    <div id="app" class="bg-white p-8 rounded-lg shadow-md w-full max-w-lg">
        <h1 class="text-3xl font-bold mb-6 text-center text-gray-800">Todo List</h1>
        <form @submit.prevent="addTodo" class="flex mb-6">
            <input
                v-model="newTodoText"
                type="text"
                placeholder="Enter a new todo"
                class="flex-grow p-2 border rounded-l-lg border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
            <button
                type="submit"
                class="p-2 bg-blue-500 text-white rounded-r-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
            >
                Add
            </button>
        </form>
        <ul class="space-y-3">
            <li v-for="todo in todos" :key="todo.id" class="p-4 border rounded-lg bg-gray-50 flex items-center justify-between">
                <span class="text-gray-700">{{ todo.text }}</span>
            </li>
        </ul>
    </div>

    <script>
        const API_URL = 'https://deployment-4p38.onrender.com'; // **IMPORTANT: Replace with your Render URL**

        const { createApp, ref, onMounted } = Vue;

        createApp({
            setup() {
                const todos = ref([]);
                const newTodoText = ref('');

                const fetchTodos = async () => {
                    try {
                        const response = await fetch(API_URL + '/todos');
                        const data = await response.json();
                        todos.value = data;
                    } catch (error) {
                        console.error('Error fetching todos:', error);
                    }
                };

                const addTodo = async () => {
                    if (!newTodoText.value.trim()) return;
                    try {
                        const response = await fetch(API_URL + '/todos', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ text: newTodoText.value }),
                        });
                        if (response.ok) {
                            newTodoText.value = '';
                            fetchTodos(); // Refresh the list
                        }
                    } catch (error) {
                        console.error('Error adding todo:', error);
                    }
                };

                onMounted(fetchTodos);

                return {
                    todos,
                    newTodoText,
                    addTodo,
                };
            },
        }).mount('#app');
    </script>
</body>
</html>
